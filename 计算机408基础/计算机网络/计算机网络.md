# 计算机网络

视频教程：【计算机网络微课堂（湖科大教书匠）】https://www.bilibili.com/video/BV1c4411d7jb?vd_source=1bbc8a9be9ea748de8b1d19c0446cafd

[TOC]

# 第一章 概述

## 1.2 因特网概述

网络、互联网和因特网

- 网络（Network）有若干结点（Node）和连接这些结点的链路（Link）组成。

- 多个网络还可以通过路由器互连起来，这样就构成了一个覆盖范围更大的网络，即互联网。因此互联网是“网络的网络”。

- 因特网（Internet）是世界上最大的互连网络。

- internet和Internet区分：

  - internet（互联网）是一个通用名词，泛指有多个计算机网络互连而成的网络，在这些网络之间的通信协议可以是任意的。
  - Internet（因特网）是一个专有名词，特指当前全球最大的、开放的、有众多网络互相连接而成的特定的计算机网络，采用TCP/IP协议族作为通信的规则，前身是ARPANET。

  

因特网发展的三个阶段：

- 1969，**第一个分组交换网ARPANET**，1983年TCPIP协议成为ARPANET的标准协议。
- 1985，NSF围绕六个大型计算机中心建设NSFNET，主干网、地区网、校园网三级结构的互联网。
- 1993，政府不再负责因特网运营，让各种因特网服务提供者ISP来运营。



因特网服务提供者ISP(Internet Service Provider)

ISP可以从因特网管理机构申请到成块的IP地址，同时拥有通信线路以及路由器等联网设备，任何机构或者个人通过向ISP交纳费用，就可以从所需要的IP地址，有了ip地址就可以上网了。我国的ISP有中国移动中国联通中国电信。

<img src="https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/image-20231018120150942.png" alt="基于ISP的三层结构的因特网" style="zoom:50%;" />



因特网的标准化工作

- 标准指定的特点是：面向大众
- RFC request for comments 技术文档
- 因特网协会ISOC是一个国际型组织，负责对因特网全面管理。
  - 因特网体系结构委员会IAB，负责管理因特网有关协议的开发。
  - 因特网工程部IETF，负责研究中短期工程问题，主要针对协议的开发和标准化。
  - 因特网研究部IRTF，从事理论方面的研究和开发一些需要长期考虑的问题。

制定因特网的正式标准经过四个阶段：

1. 因特网草案
2. 建议标准 RFC文档
3. 草案标准
4. 因特网标准



因特网的组成

- 边缘部分：由所有连接在因特网上的主机组成，这部分是用户直接使用的，用来进行通信和资源共享。
- 核心部分：由大量网络和连接这些网络的路由器组成，这部分是为边缘部分提供服务的。



## 1.3 三种交换方式

电路交换

电话交换机接通电话线的方式称为电路交换

从通信资源的分配角度看，交换就是按照某种方式动态的分配传输线路的资源。

电路交换的三个步骤：

1. 建立连接，分配通信资源
2. 通话，一直占用通信资源
3. 释放连接，归还通信资源



分组交换

在因特网中，**路由器负责分组交换**，也就是分组交换机，连接各个网络，转发接收到的分组。

发送方发送消息，这个**消息整个被称为报文**，发送前划分报文为等长数据段，在每个数据段前加上首部信息，**构成分组（包）**，首部中包含分组传输目的地址，路由器接收分组，存储分组，检查首部，按照首部中的目的地址查表转发。

发送方职责：构造分组、发送分组

路由器职责：缓存分组、转发分组

接收方职责：接收分组、还原报文



报文交换一般被分组交换所取代



三者对比

<img src="https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/image-20231018124141084.png" alt="电路交换、报文交换、分组交换对比" style="zoom: 67%;" />



## 1.4计算机网络的定义和分类

- 计算机网络的精确定义并未统一

- 计算机网络的最简单的定义是：一些互相连接的、自治的计算机的集合
  - 互连：是指计算机之间可以通过有线或无线的方式进行数据通信
  - 自治：是指独立的计算机，它有自己的硬件和软件，可以单独运行使用
  - 集合：是指至少需要两台计算机

- 计算机网络的较好的定义是：计算机网络主要是由一些通用的、可编程的硬件互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用
  - 计算机网络所连接的硬件，并不限于一般的计算机，而是包括了智能手机等智能硬件
  - 计算机网络并非专门用来传送数据，而是能够支持很多种的应用（包括今后可能出现的各种应用）




计算机网络的分类：

- 按交换技术分类：

  - 电路交换网络

  - 报文交换网络

  - 分组交换网络


- 按使用者分类：

  - 公用网

  - 专用网


- 按传输介质分类：

  - 有线网络

  - 无线网络


- 按覆盖范围分类：

  - 广域网WAN

  - 城域网MAN

  - 局域网LAN

  - 个域网PAN


- 按网络拓扑分类：

  - 总线型

  - 星型网络

  - 环型网络

  - 网状型网络




## 1.5 计算机网络的性能指标

- 比特：计算机中的数据量单位，一个比特等于二进制数字中的一个1或0。
  - 常用数据量单位：字节
  - 单位换算：1Byte = 8bit，1KB = 2的10次方B ，1MB = 2的20次方 B，1GB = 2的30次方B，1TB = 2的40次方B

- 速率：连接在计算机网络上的主机在数字信道上传送比特的速率，称为**比特率**或**数据率**。
  - 常用的数据率单位：比特每秒（bit/s、b/s、bps）
  - 单位换算：1 kb/s = 10的三次方b/s，1Mb/s = 10的六次方b/s，1Gb/s = 10的九次方b/s，1Tb/s = 10的十二次方b/s

带宽：

- 带宽在模拟信号系统中的意义：
  - **信号**所包含的各种不同频率成分所占据的**频率范围**
  - 单位：Hz、kHz、MHz、GHz
- 带宽在计算机网络中的意义：
  - 用来表示网络的**通信线路**所能传送数据的能力，因此网络带宽表示在单位时间内从网络中的某一点到另一点所能通过的“**最高数据率**“
  - 单位：（与上述速率单位一致）

> 其实，带宽的这两种表述之间有着密切的联系。一条通信线路的“频带宽度”越宽，其所传输数据的“最高数据率”也越高



吞吐量：

- 吞吐量：吞吐量表示在**单位时间内通过某个网络（或信道、接口）的数据量**
- 吞吐量**受网络的带宽或额定速率的限制**



时延：

- 发送时延 = 	分组长度 / 发送速率
- 传播时延 =    信道长度   / 电磁波传播速率
- 处理时延 = 一般不计算

时延带宽积：

- 计算：传播时延  *  带宽
- 若发送端连续发送数据，则在所发送的第一个比特即将到达终点时，发送端就已经发送了时延带宽积个比特
- 链路的时延带宽积又称为**以比特为单位的链路长度**

往返时间：

- 多数情况下，因特网上的信息不仅仅是单方向传输，而是双向交互
- 因此，**往返时间RTT（Round-Trip Time）**是一个重要指标
- 时间为：发送端发送分组开始到接收到接收端传回的确认信息为止

利用率：

- 信道利用率：某信道有百分之几的时间是被利用的（有数据通过）
- 网络利用率：全网络的信道利用率的加权平均值
- **信道利用率并非越高越好**，通信存在排队，利用率高也意味着排队产生的时延久
- <img src="https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/e8af8dcf722c70316106dc95911b2c0d.png" alt="img" style="zoom:50%;" />
  - 当网络的利用率达到50%时，时延便要加倍
  - 当网络的利用率超过50%时，时延急剧增大
  - 当网络的利用率接近100%时，时延趋于无穷大
  - 因此，一些拥有较大主干网的ISP通常会控制它们的信道利用率不超过50%。若超过了，就准备扩容，增大线路的带宽



丢包率：

- 丢包率即分组丢失率，指在一定的时间范围内，传输过程中**丢失的分组数量与总分组数量的比率**
- 丢包率具体可分为接口丢包率、结点丢包率、链路丢包率、路径丢包率、网络丢包率等
- 丢包率使网络运维人员非常关心的一个网络性能指标，但对于普通用户来说通常意识不到网络丢包
- 分组丢失主要的两种情况：
  - 分组在传输过程中出现**误码**，被结点丢弃
  - 在通信量较大时可能造成**网络拥塞**，分组到达一台队列已满的分组交换机时被丢弃
- 丢包率反映了网络的拥塞情况：
  - 无拥塞时路径丢包率为 0
  - 轻度拥塞时路径丢包率为 1% - 4%
  - 严重拥塞时路径丢包率为 5% - 15%



## 1.6 计算机网络体系结构

三种分层：

![image-20231116153359818](https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/image-20231116153359818.png)



为什么要分层？

链接：[计算机网络常见面试题总结(上) | JavaGuide(Java面试 + 学习指南)](https://javaguide.cn/cs-basics/network/other-network-questions.html#网络分层模型)



说到分层，我们先从我们平时使用框架开发一个后台程序来说，我们往往会按照每一层做不同的事情的原则将系统分为三层（复杂的系统分层会更多）:

1. Repository（数据库操作）
2. Service（业务操作）
3. Controller（前后端数据交互）

**复杂的系统需要分层，因为每一层都需要专注于一类事情。网络分层的原因也是一样，每一层只专注于做一类事情。**

好了，再来说回：“为什么网络要分层？”。我觉得主要有 3 方面的原因：

1. **各层之间相互独立**：各层之间相互独立，各层之间不需要关心其他层是如何实现的，只需要知道自己如何调用下层提供好的功能就可以了（可以简单理解为接口调用）**。这个和我们对开发时系统进行分层是一个道理。**
2. **提高了灵活性和可替换性**：每一层都可以使用最适合的技术来实现，你只需要保证你提供的功能以及暴露的接口的规则没有改变就行了。并且，每一层都可以根据需要进行修改或替换，而不会影响到整个网络的结构。**这个和我们平时开发系统的时候要求的高内聚、低耦合的原则也是可以对应上的。**
3. **大问题化小**：分层可以将复杂的网络问题分解为许多比较小的、界线比较清晰简单的小问题来处理和解决。这样使得复杂的计算机网络系统变得易于设计，实现和标准化。 **这个和我们平时开发的时候，一般会将系统功能分解，然后将复杂的问题分解为容易理解的更小的问题是相对应的，这些较小的问题具有更好的边界（目标和接口）定义。**



每一层的作用：

![image-20231116153959102](https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/image-20231116153959102.png)



专用术语：

- 实体：任何可发送或接收信息的硬件或软件进程。
- 对等实体：收发双方相同层次中的实体。
- 协议：控制两个对等实体进行逻辑通信的规则的集合。
- 协议三要素：
  - 语法：定义所交换信息的格式
  - 语义：定义收发双方所要完成的操作
  - 同步：定义收发双方的时序关系
- 服务：在协议的控制下，两个对等实体间的逻辑通信使得本层能够向上一层提供服务。
  - 要实现本层协议，还需要使用下面一层所提供的服务。
  - 协议是水平的，服务是垂直的。
  - 下层协议对上层实体透明。
- 服务访问点：在同一系统中相邻两层的实体交换信息的逻辑接口，用于区分不同的服务类型。
  - 数据链路层的服务访问点为帧的”类型“字段
  - 网络层的服务访问点为IP数据报首部中的协议字段
  - 运输层的服务访问点为端口号
- 服务原语：上层使用下层所提供的服务必须通过与下层交换一些命令，这些命令被称为服务原语。
- 协议数据单元PDU：对等层次之间传送的数据包称为该层的协议数据单元
- 服务数据单元SDU：同一系统内，层与层之间交换的数据包称为服务数据单元

![image-20231116161104346](https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/image-20231116161104346.png)



# 第二章 物理层

## 2.1 物理层的基本概念

- 物理层考虑的是怎样才能在连接各种计算机的传输媒体上传输数据比特流。
- 物理层为数据链路层屏蔽了各种传输媒体的差异，使数据链路层只需要考虑如何完成本层的协议和服务，而不必考虑网络具体的传输媒体是什么。
- 物理层协议的主要任务：
  - 机械特性：指明接口所用接线器的**形状**和**尺寸**、**引脚数目**和**排列**、**固定**和**锁定**装置
  - 电气特性：指明在接口电缆的各条线上出现的**电压的范围**
  - 功能特性：指明某条线上出现的某一电平的**电压表示何种意义**
  - 过程特性：指明对于不同功能的各种可能**事件的出现顺序**



## 2.2 物理层的传输媒体

- 导引型传输媒体：
  - 双绞线
  - 同轴电缆
  - 光纤
- 非导引型传输媒体
  - 无线电波
  - 微波
  - 红外线
  - 可见光



> 集线器：
> 集线器的英文称为“**Hub**”。“Hub”是“中心”的意思，集线器的主要功能是对接收到的信号进行**再生整形放大**，以扩大网络的传输距离，同时把所有节点集中在以它为中心的节点上。它工作于OSI(开放系统互联参考模型)参考模型第一层，即“**物理层**”。集线器与网卡、网线等传输介质一样，属于局域网中的基础设备，**采用CSMA/CD（即带冲突检测的载波监听多路访问技术)介质访问控制机制**。集线器每个接口简单的收发比特，收到1就转发1，收到0就转发0，不进行碰撞检测。集线器（hub）属于纯硬件网络底层设备，基本上不具有类似于交换机的"智能记忆"能力和"学习"能力。它也不具备交换机所具有的MAC地址表，所以它发送数据时都是没有针对性的，而是采用广播方式发送。也就是说当它要向某节点发送数据时，不是直接把数据发送到目的节点，而是把数据包发送到与集线器相连的所有节点，如图所示，简单明了。HUB是一个多端口的转发器，当以HUB为中心设备时，网络中某条线路产生了故障，并不影响其它线路的工作。所以HUB在局域网中得到了广泛的应用。大多数的时候它用在星型与树型网络拓扑结构中，以RJ45接口与各主机相连（也有BNC接口），HUB按照不同的说法有很多种类。



## 2.3 传输方式

- 串行传输和并行传输
  - 远距离传输 如计算机网络通常采用串行传输
  - 计算机内部通常采用并行传输
- 同步传输与异步传输
- 单向通信、半双工通信、全双工通信



## 2.4 编码与调制

![img](https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/03067e96ff4116bcfecd06aaff715a35.png)



- 常用编码：
  - 不归零编码
  - 归零编码
  - 曼彻斯特编码
  - 差分曼彻斯特编码
- 常用调制：
  - 基本调制方法：调幅、调频、调相，1个码元只能包含一个比特信息
  - 混合调制

## 2.5 信道的极限容量

- 失真

  <img src="https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/image-20231116194246009.png" alt="image-20231116194246009" style="zoom:50%;" />

- 失真因素：

  - 码元传输速率
  - 信号传输速率
  - 噪声干扰
  - 传输媒体质量

- 奈氏准则![image-20211009110610317](https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/5363a30c9be1898eb5b869184422a65f.png)

- 香农定理![image-20211009111001313](https://raw.githubusercontent.com/DropTheChains/blog-img/main/img/67afff4addf1526ff251f57ced649fa1.png)

- 在信道带宽一定的情况下，根据奈氏准则和香农公式，要想**提高信息的传输速率**就必须采用**多元制**（更好的调制方法）和努力**提高信道中的信噪比**

- 自从香农公式发表后，各种**新的信号处理和调制方法就不断出现**，其目的都是为了尽可能**接近香农公式给出的传输速率极限**

